<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="912px" preserveAspectRatio="none" style="width:1062px;height:912px;" version="1.1" viewBox="0 0 1062 912" width="1062px" zoomAndPan="magnify"><defs><filter height="300%" id="flgpd9hdcibfj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="234" x="415" y="24.5332">Current Process for Loading Data</text><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="663.6533" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285.5" y="151.2188"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="615.9502" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="290.5" y="189.5703"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="502.8955" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="295.5" y="258.2734"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="361.4893" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="300.5" y="377.6797"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="334.6509" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446.5" y="426.5181"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="633" y="505.708"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="171.5" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="865" y="552.3174"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="566.5986" style="stroke: #000000; stroke-width: 2.0;" width="931" x="120" y="209.9219"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="440.1924" style="stroke: #000000; stroke-width: 2.0;" width="800" x="241" y="329.3281"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="276.8125" style="stroke: #000000; stroke-width: 2.0;" width="636" x="395" y="455.3564"/><rect fill="#98FB98" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="473.708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="495.2412">DataSource</text><rect fill="#00FFFF" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="822" y="520.3174"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="829" y="541.8506">BandSource</text><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="120.8906" style="stroke: #000000; stroke-width: 2.0;" width="209" x="812" y="573.9268"/><rect fill="#FFFFFF" height="59.1875" style="stroke: none; stroke-width: 1.0;" width="209" x="812" y="635.6299"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="25" x2="25" y1="119.2188" y2="823.8721"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="290" x2="290" y1="119.2188" y2="823.8721"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="451" x2="451" y1="119.2188" y2="823.8721"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="637.5" x2="637.5" y1="507.0127" y2="823.8721"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="870" x2="870" y1="553.6221" y2="823.8721"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="8" y="116.1426">User</text><ellipse cx="25.5" cy="44.6094" fill="#FEFECE" filter="url(#flgpd9hdcibfj)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M25.5,52.6094 L25.5,79.6094 M12.5,60.6094 L38.5,60.6094 M25.5,79.6094 L12.5,94.6094 M25.5,79.6094 L38.5,94.6094 " fill="#FEFECE" filter="url(#flgpd9hdcibfj)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="8" y="837.4053">User</text><ellipse cx="25.5" cy="850.4814" fill="#FEFECE" filter="url(#flgpd9hdcibfj)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M25.5,858.4814 L25.5,885.4814 M12.5,866.4814 L38.5,866.4814 M25.5,885.4814 L12.5,900.4814 M25.5,885.4814 L38.5,900.4814 " fill="#FEFECE" filter="url(#flgpd9hdcibfj)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="251" y="82.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="258" y="104.1426">Datacube</text><rect fill="#FEFECE" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="251" y="822.8721"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="258" y="844.4053">Datacube</text><rect fill="#FEFECE" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="405" y="82.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="412" y="104.1426">DataLoader</text><rect fill="#FEFECE" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="405" y="822.8721"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="412" y="844.4053">DataLoader</text><rect fill="#98FB98" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="822.8721"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="844.4053">DataSource</text><rect fill="#00FFFF" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="822" y="822.8721"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="829" y="844.4053">BandSource</text><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="663.6533" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285.5" y="151.2188"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="615.9502" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="290.5" y="189.5703"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="502.8955" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="295.5" y="258.2734"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="361.4893" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="300.5" y="377.6797"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="334.6509" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446.5" y="426.5181"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="633" y="505.708"/><rect fill="#FFFFFF" filter="url(#flgpd9hdcibfj)" height="171.5" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="865" y="552.3174"/><polygon fill="#A80036" points="273.5,147.2188,283.5,151.2188,273.5,155.2188,277.5,151.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="25.5" x2="279.5" y1="151.2188" y2="151.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="32.5" y="146.7139">Requests some data using dc.load_data()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="295.5" x2="342.5" y1="176.9219" y2="176.9219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="342.5" y1="176.9219" y2="189.9219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="301.5" x2="342.5" y1="189.9219" y2="189.9219"/><polygon fill="#A80036" points="311.5,185.9219,301.5,189.9219,311.5,193.9219,307.5,189.9219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="307.5" y="172.0654">create_storage()</text><rect fill="none" height="566.5986" style="stroke: #000000; stroke-width: 2.0;" width="931" x="120" y="209.9219"/><polygon fill="#EEEEEE" points="120,209.9219,193,209.9219,193,217.9219,183,227.9219,120,227.9219,120,209.9219" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="135" y="224.417">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="208" y="223.3408">[for each measurement/band]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="300.5" x2="347.5" y1="245.625" y2="245.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="347.5" x2="347.5" y1="245.625" y2="258.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="306.5" x2="347.5" y1="258.625" y2="258.625"/><polygon fill="#A80036" points="316.5,254.625,306.5,258.625,316.5,262.625,312.5,258.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="312.5" y="240.7686">data_func()</text><polygon fill="#FBFB77" filter="url(#flgpd9hdcibfj)" points="140,276.625,441,276.625,451,296.625,441,316.625,140,316.625,130,296.625,140,276.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="142" y="294.1201">create a destination array in RAM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="142" y="310.4717">Dimensions are &lt;irregular dims&gt; + &lt;geobox_dims&gt;</text><rect fill="none" height="440.1924" style="stroke: #000000; stroke-width: 2.0;" width="800" x="241" y="329.3281"/><polygon fill="#EEEEEE" points="241,329.3281,314,329.3281,314,337.3281,304,347.3281,241,347.3281,241,329.3281" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="256" y="343.8232">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="329" y="342.7471">[for each time slice]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="305.5" x2="352.5" y1="365.0313" y2="365.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="352.5" y1="365.0313" y2="378.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="311.5" x2="352.5" y1="378.0313" y2="378.0313"/><polygon fill="#A80036" points="321.5,374.0313,311.5,378.0313,321.5,382.0313,317.5,378.0313" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="317.5" y="360.1748">_fuse_measurement()</text><polygon fill="#A80036" points="434.5,422.5181,444.5,426.5181,434.5,430.5181,438.5,426.5181" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="310.5" x2="440.5" y1="426.5181" y2="426.5181"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="317.5" y="422.0132">reproject_and_fuse()</text><polygon fill="#FBFB77" filter="url(#flgpd9hdcibfj)" points="461,396.0313,461,439.0313,812,439.0313,812,406.0313,802,396.0313,461,396.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="802" x2="802" y1="396.0313" y2="406.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="812" x2="802" y1="406.0313" y2="406.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="467" y="414.5264">DataLoader is not currently a class, it is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="467" y="431.5">functions in the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="559" y="430.4526">datacube.storage.storage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="755" y="431.5">module</text><rect fill="none" height="276.8125" style="stroke: #000000; stroke-width: 2.0;" width="636" x="395" y="455.3564"/><polygon fill="#EEEEEE" points="395,455.3564,468,455.3564,468,463.3564,458,473.3564,395,473.3564,395,455.3564" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="410" y="469.8516">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="483" y="468.7754">[for each DataSource]</text><polygon fill="#A80036" points="579.5,491.708,589.5,495.708,579.5,499.708,583.5,495.708" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456.5" x2="585.5" y1="495.708" y2="495.708"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="463.5" y="491.2031">read_from_source()</text><rect fill="#98FB98" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="473.708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="495.2412">DataSource</text><polygon fill="#A80036" points="810,538.3174,820,542.3174,810,546.3174,814,542.3174" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="643" x2="816" y1="542.3174" y2="542.3174"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="650" y="537.8125">open() returns BandSource</text><rect fill="#00FFFF" filter="url(#flgpd9hdcibfj)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="822" y="520.3174"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="829" y="541.8506">BandSource</text><rect fill="none" height="120.8906" style="stroke: #000000; stroke-width: 2.0;" width="209" x="812" y="573.9268"/><polygon fill="#EEEEEE" points="812,573.9268,873,573.9268,873,581.9268,863,591.9268,812,591.9268,812,573.9268" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="827" y="588.4219">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="888" y="587.3457">[Non reprojecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="917" y1="614.6299" y2="614.6299"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="917" x2="917" y1="614.6299" y2="627.6299"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="876" x2="917" y1="627.6299" y2="627.6299"/><polygon fill="#A80036" points="886,623.6299,876,627.6299,886,631.6299,882,627.6299" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="882" y="609.7734">_read_decimated()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="812" x2="1021" y1="636.6299" y2="636.6299"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="817" y="648.0488">[ReProjecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="917" y1="673.8174" y2="673.8174"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="917" x2="917" y1="673.8174" y2="686.8174"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="876" x2="917" y1="686.8174" y2="686.8174"/><polygon fill="#A80036" points="886,682.8174,876,686.8174,886,690.8174,882,686.8174" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="882" y="668.9609">reproject()</text><polygon fill="#A80036" points="649,719.8174,639,723.8174,649,727.8174,645,723.8174" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="643" x2="869" y1="723.8174" y2="723.8174"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="655" y="719.3125">append data into destination array</text><polygon fill="#A80036" points="311.5,757.1689,301.5,761.1689,311.5,765.1689,307.5,761.1689" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="305.5" x2="450.5" y1="761.1689" y2="761.1689"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="317.5" y="756.6641">return data</text><polygon fill="#A80036" points="36.5,801.5205,26.5,805.5205,36.5,809.5205,32.5,805.5205" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="30.5" x2="284.5" y1="805.5205" y2="805.5205"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="42.5" y="801.0156">return data</text><!--
@startuml

title Current Process for Loading Data
'!include ..\datacube-core\docs\plantuml.cfg

actor User

participant Datacube


User -> Datacube: Requests some data using dc.load_data()
activate Datacube

Datacube -> Datacube: create_storage()
activate Datacube
loop for each measurement/band
  Datacube -> Datacube: data_func()
  activate Datacube
  hnote over Datacube
    create a destination array in RAM
    Dimensions are <irregular dims> + <geobox_dims>
  end note
  loop for each time slice
    Datacube -> Datacube: _fuse_measurement()
    activate Datacube
    Datacube -> DataLoader:  reproject_and_fuse()
    note right
        DataLoader is not currently a class, it is 
        functions in the ""datacube.storage.storage"" module
    end note
    activate DataLoader
    participant DataSource #PaleGreen
    loop for each DataSource
        create DataSource
        DataLoader -> DataSource: read_from_source()
        activate DataSource

        participant BandSource #Cyan
        create BandSource
        DataSource -> BandSource: open() returns BandSource
        activate BandSource
        alt Non reprojecting read
            BandSource -> BandSource: _read_decimated()
        else ReProjecting read
            BandSource -> BandSource: reproject()
        end
        BandSource - -> DataSource: append data into destination array
        deactivate BandSource
        deactivate DataSource
    end
    deactivate Datacube
    DataLoader - -> Datacube: return data
    deactivate DataLoader

    deactivate Datacube
  end
end

Datacube - -> User: return data
deactivate Datacube


@enduml

PlantUML version 1.2017.19(Sun Nov 12 22:46:22 AEDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_121-b15
Operating System: Windows 7
OS Version: 6.1
Default Encoding: Cp1252
Language: en
Country: AU
--></g></svg>