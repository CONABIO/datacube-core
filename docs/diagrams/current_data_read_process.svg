<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="880px" preserveAspectRatio="none" style="width:1067px;height:880px;" version="1.1" viewBox="0 0 1067 880" width="1067px" zoomAndPan="magnify"><defs><filter height="300%" id="fyzyghg6ci0iw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="663.6533" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285.5" y="119.6094"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="615.9502" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="290.5" y="157.9609"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="502.8955" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="295.5" y="226.6641"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="361.4893" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="300.5" y="346.0703"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="334.6509" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446.5" y="394.9087"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="633" y="474.0986"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="474.0986"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="566.5986" style="stroke: #000000; stroke-width: 2.0;" width="936" x="120" y="178.3125"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="440.1924" style="stroke: #000000; stroke-width: 2.0;" width="805" x="241" y="297.7188"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="276.8125" style="stroke: #000000; stroke-width: 2.0;" width="641" x="395" y="423.7471"/><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="442.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="463.6318">DataSource</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="827" y="488.708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="834" y="510.2412">BandSource</text><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="120.8906" style="stroke: #000000; stroke-width: 2.0;" width="209" x="817" y="542.3174"/><rect fill="#FFFFFF" height="59.1875" style="stroke: none; stroke-width: 1.0;" width="209" x="817" y="604.0205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="25" x2="25" y1="87.6094" y2="792.2627"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="290" x2="290" y1="87.6094" y2="792.2627"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="451" x2="451" y1="87.6094" y2="792.2627"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="637.5" x2="637.5" y1="475.4033" y2="792.2627"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="875" x2="875" y1="522.0127" y2="792.2627"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="8" y="84.5332">User</text><ellipse cx="25.5" cy="13" fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M25.5,21 L25.5,48 M12.5,29 L38.5,29 M25.5,48 L12.5,63 M25.5,48 L38.5,63 " fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="8" y="805.7959">User</text><ellipse cx="25.5" cy="818.8721" fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M25.5,826.8721 L25.5,853.8721 M12.5,834.8721 L38.5,834.8721 M25.5,853.8721 L12.5,868.8721 M25.5,853.8721 L38.5,868.8721 " fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="251" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="258" y="72.5332">Datacube</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="251" y="791.2627"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="258" y="812.7959">Datacube</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="405" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="412" y="72.5332">DataLoader</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="405" y="791.2627"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="412" y="812.7959">DataLoader</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="791.2627"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="812.7959">DataSource</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="827" y="791.2627"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="834" y="812.7959">BandSource</text><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="663.6533" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="285.5" y="119.6094"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="615.9502" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="290.5" y="157.9609"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="502.8955" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="295.5" y="226.6641"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="361.4893" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="300.5" y="346.0703"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="334.6509" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="446.5" y="394.9087"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="633" y="474.0986"/><rect fill="#FFFFFF" filter="url(#fyzyghg6ci0iw)" height="218.1094" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="474.0986"/><polygon fill="#A80036" points="273.5,115.6094,283.5,119.6094,273.5,123.6094,277.5,119.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="25.5" x2="279.5" y1="119.6094" y2="119.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="32.5" y="115.1045">Requests some data using dc.load_data()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="295.5" x2="342.5" y1="145.3125" y2="145.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342.5" x2="342.5" y1="145.3125" y2="158.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="301.5" x2="342.5" y1="158.3125" y2="158.3125"/><polygon fill="#A80036" points="311.5,154.3125,301.5,158.3125,311.5,162.3125,307.5,158.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="307.5" y="140.4561">create_storage()</text><rect fill="none" height="566.5986" style="stroke: #000000; stroke-width: 2.0;" width="936" x="120" y="178.3125"/><polygon fill="#EEEEEE" points="120,178.3125,193,178.3125,193,186.3125,183,196.3125,120,196.3125,120,178.3125" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="135" y="192.8076">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="208" y="191.7314">[for each measurement/band]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="300.5" x2="347.5" y1="214.0156" y2="214.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="347.5" x2="347.5" y1="214.0156" y2="227.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="306.5" x2="347.5" y1="227.0156" y2="227.0156"/><polygon fill="#A80036" points="316.5,223.0156,306.5,227.0156,316.5,231.0156,312.5,227.0156" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="312.5" y="209.1592">data_func()</text><polygon fill="#FBFB77" filter="url(#fyzyghg6ci0iw)" points="140,245.0156,441,245.0156,451,265.0156,441,285.0156,140,285.0156,130,265.0156,140,245.0156" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="142" y="262.5107">create a destination array in RAM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="142" y="278.8623">Dimensions are &lt;irregular dims&gt; + &lt;geobox_dims&gt;</text><rect fill="none" height="440.1924" style="stroke: #000000; stroke-width: 2.0;" width="805" x="241" y="297.7188"/><polygon fill="#EEEEEE" points="241,297.7188,314,297.7188,314,305.7188,304,315.7188,241,315.7188,241,297.7188" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="256" y="312.2139">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="223" x="329" y="311.1377">[for each time/irregular dimension slice]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="305.5" x2="352.5" y1="333.4219" y2="333.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="352.5" y1="333.4219" y2="346.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="311.5" x2="352.5" y1="346.4219" y2="346.4219"/><polygon fill="#A80036" points="321.5,342.4219,311.5,346.4219,321.5,350.4219,317.5,346.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="317.5" y="328.5654">_fuse_measurement()</text><polygon fill="#A80036" points="434.5,390.9087,444.5,394.9087,434.5,398.9087,438.5,394.9087" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="310.5" x2="440.5" y1="394.9087" y2="394.9087"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="317.5" y="390.4038">reproject_and_fuse()</text><polygon fill="#FBFB77" filter="url(#fyzyghg6ci0iw)" points="461,364.4219,461,407.4219,812,407.4219,812,374.4219,802,364.4219,461,364.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="802" x2="802" y1="364.4219" y2="374.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="812" x2="802" y1="374.4219" y2="374.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="467" y="382.917">DataLoader is not currently a class, it is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="467" y="399.8906">functions in the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="559" y="398.8433">datacube.storage.storage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="755" y="399.8906">module</text><rect fill="none" height="276.8125" style="stroke: #000000; stroke-width: 2.0;" width="641" x="395" y="423.7471"/><polygon fill="#EEEEEE" points="395,423.7471,468,423.7471,468,431.7471,458,441.7471,395,441.7471,395,423.7471" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="410" y="438.2422">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="483" y="437.166">[for each DataSource]</text><polygon fill="#A80036" points="579.5,460.0986,589.5,464.0986,579.5,468.0986,583.5,464.0986" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456.5" x2="585.5" y1="464.0986" y2="464.0986"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="463.5" y="459.5938">read_from_source()</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="591.5" y="442.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="598.5" y="463.6318">DataSource</text><polygon fill="#A80036" points="810,506.708,820,510.708,810,514.708,814,510.708" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="643" x2="816" y1="510.708" y2="510.708"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="650" y="506.2031">open() returns BandSource</text><rect fill="#FEFECE" filter="url(#fyzyghg6ci0iw)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="827" y="488.708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="834" y="510.2412">BandSource</text><rect fill="none" height="120.8906" style="stroke: #000000; stroke-width: 2.0;" width="209" x="817" y="542.3174"/><polygon fill="#EEEEEE" points="817,542.3174,878,542.3174,878,550.3174,868,560.3174,817,560.3174,817,542.3174" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="832" y="556.8125">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="893" y="555.7363">[Non reprojecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="583.0205" y2="583.0205"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="583.0205" y2="596.0205"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="596.0205" y2="596.0205"/><polygon fill="#A80036" points="891,592.0205,881,596.0205,891,600.0205,887,596.0205" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="887" y="578.1641">_read_decimated()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="817" x2="1026" y1="605.0205" y2="605.0205"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="822" y="616.4395">[ReProjecting read]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="642.208" y2="642.208"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="642.208" y2="655.208"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="655.208" y2="655.208"/><polygon fill="#A80036" points="891,651.208,881,655.208,891,659.208,887,655.208" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="887" y="637.3516">reproject()</text><polygon fill="#A80036" points="649,688.208,639,692.208,649,696.208,645,692.208" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="643" x2="874" y1="692.208" y2="692.208"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="655" y="687.7031">append data into destination array</text><polygon fill="#A80036" points="311.5,725.5596,301.5,729.5596,311.5,733.5596,307.5,729.5596" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="305.5" x2="450.5" y1="729.5596" y2="729.5596"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="317.5" y="725.0547">return data</text><polygon fill="#A80036" points="36.5,769.9111,26.5,773.9111,36.5,777.9111,32.5,773.9111" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="30.5" x2="284.5" y1="773.9111" y2="773.9111"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="42.5" y="769.4063">return data</text><!--
@startuml

'!include ..\datacube-core\docs\plantuml.cfg

actor User

participant Datacube


User -> Datacube: Requests some data using dc.load_data()
activate Datacube

Datacube -> Datacube: create_storage()
activate Datacube
loop for each measurement/band
  Datacube -> Datacube: data_func()
  activate Datacube
  hnote over Datacube
    create a destination array in RAM
    Dimensions are <irregular dims> + <geobox_dims>
  end note
  loop for each time/irregular dimension slice
    Datacube -> Datacube: _fuse_measurement()
    activate Datacube
    Datacube -> DataLoader:  reproject_and_fuse()
    note right
        DataLoader is not currently a class, it is 
        functions in the ""datacube.storage.storage"" module
    end note
    activate DataLoader
    loop for each DataSource
        create DataSource
        DataLoader -> DataSource: read_from_source()
        activate DataSource

        create BandSource
        activate BandSource
        DataSource -> BandSource: open() returns BandSource
        alt Non reprojecting read
            BandSource -> BandSource: _read_decimated()
        else ReProjecting read
            BandSource -> BandSource: reproject()
        end
        BandSource - -> DataSource: append data into destination array
        deactivate BandSource
        deactivate DataSource
    end
    deactivate Datacube
    DataLoader - -> Datacube: return data
    deactivate DataLoader

    deactivate Datacube
  end
end

Datacube - -> User: return data
deactivate Datacube


@enduml

PlantUML version 1.2017.19(Sun Nov 12 22:46:22 AEDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_121-b15
Operating System: Windows 7
OS Version: 6.1
Default Encoding: Cp1252
Language: en
Country: AU
--></g></svg>